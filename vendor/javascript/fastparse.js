var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var t={};function ignoreFunction(){}function createReturningFunction(e){return function(){return e}}function Parser(t){(this||e).states=this.compileStates(t)}Parser.prototype.compileStates=function(t){var r={};Object.keys(t).forEach((function(e){r[e]=this.compileState(t[e],t)}),this||e);return r};Parser.prototype.compileState=function(e,t){var r=[];function iterator(e,t){r.push({groups:Parser.getGroupCount(e),regExp:e,value:t})}function processState(e){if(Array.isArray(e))e.forEach(processState);else if("object"===typeof e)Object.keys(e).forEach((function(t){iterator(t,e[t])}));else{if("string"!==typeof e)throw new Error("Unexpected 'state' format");processState(t[e])}}processState(e);var n=r.map((function(e){return"("+e.regExp+")"})).join("|");var o=[];var a=1;r.forEach((function(e){var t;t="function"===typeof e.value?e.value:"string"===typeof e.value?createReturningFunction(e.value):ignoreFunction;o.push({name:e.regExp,fn:t,pos:a,pos2:a+e.groups+1});a+=e.groups+1}));return{regExp:new RegExp(n,"g"),actions:o}};Parser.getGroupCount=function(e){return new RegExp("("+e+")|^$").exec("").length-2};Parser.prototype.parse=function(t,r,n){n=n||{};var o=t;var a=0;for(;;){var s=(this||e).states[o];var i=s.regExp;i.lastIndex=a;var p=i.exec(r);if(!p)return n;var c=s.actions;a=s.regExp.lastIndex;for(var u=0;u<c.length;u++){var f=c[u];if(p[f.pos]){var l=f.fn.apply(n,Array.prototype.slice.call(p,f.pos,f.pos2).concat([s.regExp.lastIndex-p[0].length,p[0].length]));if(l){if(!(l in(this||e).states))throw new Error("State '"+l+"' doesn't exist");o=l}break}}}};t=Parser;var r=t;export default r;

